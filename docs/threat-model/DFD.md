# Диаграмма потоков данных (DFD) - Система бронирования парковочных мест

```mermaid
graph TD
    subgraph Внешняя_зона [Внешние пользователи]
        П[Пользователь]
        А[Администратор]
        М[Мобильное приложение]
    end

    subgraph Периметровая_зона [Периметр безопасности]
        Б[Балансировщик нагрузки]
        МЭ[Межсетевой экран]
    end

    subgraph Приложение [Зона приложения]
        API[FastAPI приложение]
        АУТ[Сервис аутентификации]
        ЛИМ[Ограничитель запросов]
    end

    subgraph Данные [Зона данных]
        БД[(База данных PostgreSQL)]
        КЭШ[(Кэш Redis)]
    end
    %% Границы доверия
    П -->|F1: HTTPS| Б
    А -->|F2: HTTPS| Б
    М -->|F3: HTTPS| Б

    Б -->|F4: HTTP| МЭ
    МЭ -->|F5: HTTP| API

    API -->|F6: Проверка токена| АУТ
    API -->|F7: Проверка лимитов| ЛИМ
    API -->|F8: SQL запросы| БД
    API -->|F9: Операции кэша| КЭШ

    АУТ -->|F10: Данные пользователей| БД
    ЛИМ -->|F11: Счетчики запросов| КЭШ
```

## Описание потоков данных
| ID потока | Описание | Протокол | Данные |
|-----------|----------|----------|--------|
| F1 | Браузер пользователя к балансировщику | HTTPS | HTTP запросы |
| F2 | Администратор к балансировщику | HTTPS | Администрирование |
| F3 | Мобильное приложение к балансировщику | HTTPS | API вызовы |
| F4 | Балансировка трафика | HTTP | Трафик приложения |
| F5 | Отфильтрованный трафик к приложению | HTTP | Проверенные запросы |
| F6 | Проверка JWT токена | Внутренний | Верификация токена |
| F7 | Проверка ограничений запросов | Внутренний | Подсчет запросов |
| F8 | Операции с базой данных | SQL | Данные пользователей/слотов/бронирований |
| F9 | Операции с кэшем | Redis | Сессии/доступность |
| F10 | Данные аутентификации | SQL | Учетные данные |
| F11 | Данные ограничений | Redis | Счетчики запросов |
