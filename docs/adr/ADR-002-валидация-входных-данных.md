# ADR-002: Строгая валидация входных данных

## Статус
Принято

## Контекст
Невалидированные входные данные представляют угрозу безопасности. Для системы бронирования критически важна целостность данных о парковочных местах и бронированиях.

## Решение
Реализовать многоуровневую валидацию:
1. **Pydantic-схемы** для проверки типов, длин и форматов
2. **Кастомные валидаторы** (строгие пароли, даты только в будущем, нормализация кодов слотов)
3. **Параметризованные SQL-запросы** в `sqlite3` вместо ручной конкатенации

Конкретные правила:
- Даты бронирования не могут быть в прошлом
- Коды парковочных мест: только буквы и цифры, 2-10 символов
- Email валидация по RFC
- Ограничение длины строковых полей

## Последствия
### Положительные
- Защита от распространенных уязвимостей
- Чистота данных в системе
- Предсказуемое поведение API

### Отрицательные
- Усложнение кода валидации
- Необходимость обработки ошибок валидации

## Связи
- **NFR**: SEC-003 (Валидация входных данных)
- **Угрозы**: F8 (Tampering), R-01 (SQL инъекции), R-11 (Невалидные данные)
- **Тесты**: `tests/test_auth.py::test_register_password_exceeds_bcrypt_limit`, `tests/test_bookings.py::test_booking_validation_rejects_past_date`
- **Код**: `app/schemas/validation.py`, `app/api/items.py`, `app/api/bookings.py`
